"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function e(e,t,n,a){return new(n||(n=Promise))((function(o,l){function r(e){try{c(a.next(e))}catch(e){l(e)}}function i(e){try{c(a.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,i)}c((a=a.apply(e,t||[])).next())}))}(function(){return e(this,void 0,void 0,(function*(){yield figma.loadFontAsync({family:"Roboto",style:"Regular"}),yield figma.loadFontAsync({family:"Roboto",style:"Bold"})}))})().then(()=>{let e,t,n,a,o=figma.currentPage.selection,l=figma.currentPage.selection,r=figma.currentPage,i=!1,c=!1,s=!1,u=!1,g=[],h=[],f=[],m=[],d=[],p=null;function b(e,t){figma.clientStorage.setAsync(e,JSON.stringify(t)).catch(e=>{console.log("error setting data")})}function y(e){const t=e.match(/"(.*?)"/);return t?a=t[1]:e}function x(e,t){setTimeout(()=>{if(t.length>0){figma.group(t,r).name=e.name+" / Notation",t=[]}},300)}function O(e,t,n,o){let l,r,i=figma.createRectangle(),c=figma.createText(),s=figma.createFrame(),u=figma.createFrame(),d=figma.createPolygon(),b=figma.createFrame();if(i.x=e,i.y=t,i.resize(o.width,o.height),i.strokeWeight=2,i.strokeAlign="OUTSIDE",i.cornerRadius=4,i.name="Target: "+o.name+" : "+o.id,c.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}],c.fontSize=13,d.resize(33,33),d.rotation=90,b.fills=[],b.resize(33,33),u.layoutMode="HORIZONTAL",u.horizontalPadding=9,u.verticalPadding=9,u.primaryAxisSizingMode="AUTO",u.primaryAxisAlignItems="MIN",u.counterAxisAlignItems="CENTER",u.cornerRadius=6,s.layoutMode="HORIZONTAL",s.name="Dimensions: "+o.name+" : "+o.id,s.fills=[],s.primaryAxisSizingMode="AUTO",s.primaryAxisAlignItems="MIN",s.counterAxisAlignItems="CENTER",s.x=e+o.width+10,s.y=t+o.height/2-16,b.appendChild(d),d.x=0,d.y=33,"target"===n){let e=(Math.round(10*o.width)/10).toFixed(0),t=(Math.round(10*o.height)/10).toFixed(0);i.fills=[{type:"SOLID",opacity:.1,color:{r:209/255,g:1/255,b:167/255}}],i.strokes=[{type:"SOLID",color:{r:209/255,g:1/255,b:167/255}}],c.characters=e+" x "+t,d.fills=[{type:"SOLID",color:{r:209/255,g:1/255,b:167/255}}],u.fills=[{type:"SOLID",color:{r:209/255,g:1/255,b:167/255}}],g.push(s),g.push(i)}"target"!==n&&(l=figma.createText(),r=figma.createText(),l.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}],l.fontSize=13,r.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}],r.fontSize=13,r.characters='"'),"alt"===n&&(y(o.name),null!==p?(l.characters='Alt="',c.characters=p,p=null):null==a?(l.characters="",c.characters="Alt",r.characters=""):(l.characters='Alt="',c.characters=a,a=null),i.fills=[{type:"SOLID",opacity:.1,color:{r:98/255,g:68/255,b:1}}],i.strokes=[{type:"SOLID",color:{r:98/255,g:68/255,b:1}}],d.fills=[{type:"SOLID",color:{r:98/255,g:68/255,b:1}}],u.fills=[{type:"SOLID",color:{r:98/255,g:68/255,b:1}}],h.push(s),h.push(i)),"button"===n&&(y(o.name),null!==p?(l.characters='Button="',c.characters=p,p=null):null==a?(l.characters="",c.characters="Button",r.characters=""):(l.characters='Button="',c.characters=a,a=null),i.fills=[{type:"SOLID",opacity:.1,color:{r:181/255,g:0,b:0}}],i.strokes=[{type:"SOLID",color:{r:181/255,g:0,b:0}}],d.fills=[{type:"SOLID",color:{r:181/255,g:0,b:0}}],u.fills=[{type:"SOLID",color:{r:181/255,g:0,b:0}}],f.push(s),f.push(i)),"label"===n&&(y(o.name),null!==p?(l.characters='Label="',c.characters=p,p=null):null==a?(l.characters="",c.characters="Label",r.characters=""):(l.characters='Label="',c.characters=a,a=null),i.fills=[{type:"SOLID",opacity:.1,color:{r:1,g:199/255,b:0}}],i.strokes=[{type:"SOLID",color:{r:1,g:199/255,b:0}}],d.fills=[{type:"SOLID",color:{r:1,g:199/255,b:0}}],u.fills=[{type:"SOLID",color:{r:1,g:199/255,b:0}}],c.fills=[{type:"SOLID",color:{r:0,g:0,b:0}}],l.fills=[{type:"SOLID",color:{r:0,g:0,b:0}}],r.fills=[{type:"SOLID",color:{r:0,g:0,b:0}}],m.push(s),m.push(i)),s.appendChild(b),s.appendChild(u),"target"!==n&&u.appendChild(l),u.appendChild(c),"target"!==n&&u.appendChild(r),b.resize(7,33),u.counterAxisSizingMode="AUTO",s.counterAxisSizingMode="AUTO"}function A(e,t){let o,l,r=e.name,i=e.mainComponent;for(var c in i)"description"==`${c}`&&(l=`${i[c]}`),"id"==`${c}`&&(o=`${i[c]}`);let s=e.absoluteTransform,u=s[0][2],g=s[1][2],h=u+n+100,f=g;"target"===t&&(r.indexOf("@target")>=0?O(h,f,t,e):null!=l&&l.length>0&&l.indexOf("@target")>=0&&(y(l),O(h,f,t,e),a=null)),"alt"===t&&(r.indexOf("@alt")>=0?O(h,f,t,e):null!=l&&l.length>0&&l.indexOf("@alt")>=0&&(y(l),O(h,f,t,e),a=null)),"button"===t&&(r.indexOf("@button")>=0?O(h,f,t,e):null!=l&&l.length>0&&l.indexOf("@button")>=0&&(y(l),O(h,f,t,e),a=null)),"label"===t&&(r.indexOf("@label")>=0?O(h,f,t,e):null!=l&&l.length>0&&l.indexOf("@label")>=0&&(y(l),O(h,f,t,e),a=null))}function S(a,o,l,r){a.forEach(a=>{r=a.clone();let i=a.width;n=a.width,e=a.id,t=a.name;let c=a.absoluteTransform,s=c[0][2],u=c[1][2];r.name=a.name+" / "+l+" / "+e,r.x=s+i+100,r.y=u,r.locked=!0,!0===o.screen&&!0===o.touch&&(r.name===a.name+" / Alt / "+e&&(r.x=s+2*i+200),r.name===a.name+" / Button / "+e&&(r.x=s+3*i+300)),!0===o.touch&&!0===o.screen&&!0===o.button&&r.name===a.name+" / Label / "+e&&(r.x=s+4*i+400),!1===o.touch&&!0===o.screen&&!0===o.button&&(r.name===a.name+" / Button / "+e&&(r.x=s+2*i+200),r.name===a.name+" / Label / "+e&&(r.x=s+3*i+300)),!0===o.touch&&!1===o.screen&&!0===o.button&&(r.name===a.name+" / Button / "+e&&(r.x=s+2*i+200),r.name===a.name+" / Label / "+e&&(r.x=s+3*i+300)),!0===o.touch&&!0===o.screen&&!1===o.button&&r.name===a.name+" / Label / "+e&&(r.x=s+3*i+300),(!1===o.touch&&!1===o.screen&&!0===o.button||!1===o.touch&&!0===o.screen&&!1===o.button||!0===o.touch&&!1===o.screen&&!1===o.button)&&r.name===a.name+" / Label / "+e&&(r.x=s+2*i+200)})}function I(e){!0===i&&A(e,"target"),!0===c&&A(e,"alt"),!0===s&&A(e,"button"),!0===u&&A(e,"label")}function L(e){e.forEach(e=>{let t=e.absoluteTransform;t[0][2],t[1][2];I(e),e.children&&function e(t){t.forEach(t=>{I(t),"children"in t&&e(t.children)})}(e.children)})}figma.showUI(__html__,{width:324,height:430}),new Promise((e,t)=>{figma.clientStorage.getAsync("onboarding").then(t=>{let n=t?JSON.parse(t):[];e(n),figma.ui.postMessage({onboarding:n})}).catch(e=>{t(e)})}),setInterval((function(){let e=figma.currentPage.selection;0===e.length?figma.ui.postMessage({now:"Nothing selected"}):e.length>=2?figma.ui.postMessage({now:"Multiple selections"}):e.forEach(e=>{e.name;figma.ui.postMessage({now:e.name})})}),1200),figma.ui.onmessage=a=>{if("generate"===a.type){if(o=figma.currentPage.selection,0===o.length)return void figma.ui.postMessage({selection:!1});if(!0===a.touch?(i=!0,l=null,l=figma.currentPage.selection,l.forEach(e=>{n=e.width}),S(l,a,"Target",void 0),setTimeout(()=>{if(g.length>0){figma.group(g,r).name="Touch Targets",g=[]}else d.push("No @target found");g=[]},300)):i=!1,!0===a.screen){let e;c=!0,l=figma.currentPage.selection,l.forEach(t=>{e=t.width}),S(l,a,"Alt",void 0),setTimeout(()=>{if(!0===a.touch&&h.length>0&&h.forEach(t=>{let n=t.x;t.x=n+e+100}),h.length>0){figma.group(h,r).name="Alt",h=[]}else d.push("No @alt found")},300)}else c=!1;if(!0===a.button){let e;s=!0,l=figma.currentPage.selection,l.forEach(t=>{e=t.width}),S(l,a,"Button",void 0),setTimeout(()=>{if((!0===a.touch&&f.length>0||!0===a.screen&&f.length)&&f.forEach(t=>{let n=t.x;t.x=n+e+100}),!0===a.touch&&!0===a.screen&&f.length>0&&f.forEach(t=>{let n=t.x;t.x=n+e+100}),f.length>0){figma.group(f,r).name="Button",f=[]}else d.push("No @button found")},300)}else s=!1;if(!0===a.label){let e;u=!0,l=figma.currentPage.selection,l.forEach(t=>{e=t.width}),S(l,a,"Label",void 0),setTimeout(()=>{if(!0!==a.touch&&!0!==a.screen&&!0!==a.button||m.forEach(t=>{let n=t.x;t.x=n+e+100}),(!0===a.touch&&!0===a.screen||!0===a.touch&&!0===a.button||!0===a.screen&&!0===a.button)&&m.forEach(t=>{let n=t.x;t.x=n+e+100}),!0===a.touch&&!0===a.screen&&!0===a.button&&m.forEach(t=>{let n=t.x;t.x=n+e+100}),m.length>0){figma.group(m,r).name="Label",m=[]}else d.push("No @label found")},300)}else u=!1;L(o),setTimeout(()=>{d.length>0&&d.forEach(n=>{let a=figma.createText(),o=figma.createFrame();a.characters=n,a.fontSize=13,o.name="Annotator Noty",o.cornerRadius=6,o.layoutMode="VERTICAL",o.fills=[{type:"SOLID",color:{r:1,g:199/255,b:0}}],o.horizontalPadding=20,o.verticalPadding=10,o.primaryAxisSizingMode="AUTO",o.counterAxisSizingMode="AUTO",o.primaryAxisAlignItems="CENTER",o.counterAxisAlignItems="CENTER",o.appendChild(a),figma.currentPage.children.forEach(a=>{let l=a.x,r=a.y;a.name===t+" / Alt / "+e&&"No @alt found"===n&&(o.x=l,o.y=r-60),a.name===t+" / Target / "+e&&"No @target found"===n&&(o.x=l,o.y=r-60),a.name===t+" / Button / "+e&&"No @button found"===n&&(o.x=l,o.y=r-60),a.name===t+" / Label / "+e&&"No @label found"===n&&(o.x=l,o.y=r-60)})}),d=[]},500)}"close"===a.type&&(b("onboarding",a.onboard),figma.closePlugin()),"manual"===a.type&&(o=figma.currentPage.selection,o.forEach(e=>{let t=e.absoluteTransform,n=t[0][2],o=t[1][2];"target"===a.select&&(O(n,o,"target",e),x(e,g),g=[]),"alt"===a.select&&(p=a.desc,O(n,o,"alt",e),x(e,h),h=[]),"button"===a.select&&(p=a.desc,O(n,o,"button",e),x(e,f),f=[]),"label"===a.select&&(p=a.desc,O(n,o,"label",e),x(e,m),m=[])})),b("onboarding",a.onboard)}});
